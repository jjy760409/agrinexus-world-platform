
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>AgriNexus ê³„ì•½ ì—…ë¡œë“œ + ì´ë ¥ ê´€ë¦¬ + ì„œëª… ì´ë¯¸ì§€</title>
  <style>
    body { font-family: Arial; padding: 2rem; background: #f4f4f4; }
    input, textarea, select, button { width: 100%; padding: 0.8rem; margin-top: 1rem; font-size: 1rem; border-radius: 6px; border: 1px solid #ccc; }
    button { background: #007c4d; color: white; border: none; cursor: pointer; }
    h2 { color: #004b8d; margin-top: 2rem; }
    ul { background: #fff; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    li { margin-bottom: 0.5rem; }
    iframe { border: 1px solid #ccc; width: 100%; height: 300px; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>ğŸ“ AgriNexus ê³„ì•½ ì—…ë¡œë“œ + ê´€ë¦¬ì ê²€í†  ì‹œìŠ¤í…œ</h1>

  <h2>â‘  ê³„ì•½ì„œ ì—…ë¡œë“œ</h2>
  <input type="file" id="contractFile" accept="application/pdf"/>
  <button onclick="previewFile()">ğŸ‘€ ê³„ì•½ì„œ ë¯¸ë¦¬ë³´ê¸°</button>
  <iframe id="fileViewer"></iframe>

  <h2>â‘¡ ì‚¬ìš©ìë³„ ê³„ì•½ ì´ë ¥ ì €ì¥</h2>
  <input type="text" id="userName" placeholder="ì‚¬ìš©ì ì´ë¦„" />
  <button onclick="saveHistory()">ğŸ“Œ ì´ë ¥ ì €ì¥</button>
  <ul id="historyList"></ul>

  <h2>â‘¢ ì „ìì„œëª… ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ</h2>
  <input type="file" id="signatureImage" accept="image/*" />
  <img id="signaturePreview" width="200" style="margin-top:1rem;" />

  <script>
    function previewFile() {
      const file = document.getElementById('contractFile').files[0];
      if (file) {
        const url = URL.createObjectURL(file);
        document.getElementById('fileViewer').src = url;
      }
    }

    function saveHistory() {
      const name = document.getElementById('userName').value;
      const file = document.getElementById('contractFile').files[0];
      const signature = document.getElementById('signatureImage').files[0];
      if (!name || !file || !signature) {
        alert("ì´ë¦„, ê³„ì•½ì„œ, ì„œëª… ì´ë¯¸ì§€ê°€ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤.");
        return;
      }
      const reader = new FileReader();
      reader.onload = function() {
        const record = {
          name,
          filename: file.name,
          signImage: reader.result,
          time: new Date().toLocaleString()
        };
        let logs = JSON.parse(localStorage.getItem("contractLogs") || "[]");
        logs.push(record);
        localStorage.setItem("contractLogs", JSON.stringify(logs));
        renderHistory();
        alert("ğŸ“ ê³„ì•½ ì´ë ¥ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
      };
      reader.readAsDataURL(signature);
    }

    function renderHistory() {
      const list = document.getElementById("historyList");
      const logs = JSON.parse(localStorage.getItem("contractLogs") || "[]");
      list.innerHTML = "";
      logs.forEach(log => {
        const li = document.createElement("li");
        li.innerHTML = `ğŸ“Œ [${log.time}] ${log.name} - ${log.filename}<br/>
        <img src="${log.signImage}" width="150"/>`;
        list.appendChild(li);
      });
    }

    document.getElementById('signatureImage').onchange = function(e) {
      const img = document.getElementById('signaturePreview');
      const file = e.target.files[0];
      if (file) {
        const url = URL.createObjectURL(file);
        img.src = url;
      }
    };

    window.onload = renderHistory;
  </script>
</body>
</html>
