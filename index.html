
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AgriNexus Slack PDF ë§í¬ + ìë™ ì‹¤í–‰ + ê²½ê³  ì•Œë¦¼</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial; padding: 2rem; background: #f8fcff; text-align: center; }
    input, button, textarea { padding: 0.8rem; font-size: 1rem; margin: 0.5rem; width: 90%; max-width: 500px; border-radius: 6px; border: 1px solid #ccc; }
    .section { background: white; padding: 1.5rem; margin: 2rem auto; max-width: 800px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
  </style>
</head>
<body>

  <h1>ğŸ“© AgriNexus Slack PDF + ì‘ë‹µ ì‹¤íŒ¨ ê²½ê³  + ìë™ ì‹¤í–‰</h1>

  <div class="section">
    <h3>ğŸ“ PDF ë¦¬í¬íŠ¸ ìƒì„± + Slack ë§í¬ í¬í•¨ ì „ì†¡</h3>
    <textarea id="summaryText" placeholder="PDF ìš”ì•½ ë‚´ìš© ì…ë ¥"></textarea>
    <button onclick="sendSlackWithPDF()">Slack ì „ì†¡</button>
    <div id="slackStatus" style="margin-top:1rem; color:#007c4d;"></div>
  </div>

  <div class="section">
    <h3>âš ï¸ IoT ì‘ë‹µ ì‹¤íŒ¨ ê°ì§€ ì‹œ ìë™ ê²½ê³ </h3>
    <button onclick="simulateIoTFailure()">IoT ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸</button>
    <div id="alertResult" style="margin-top:1rem; color:#e63946;"></div>
  </div>

  <div class="section">
    <h3>ğŸ›  ê´€ë¦¬ì ìŠ¹ì¸ â†’ ìë™ í–‰ë™ ì‹¤í–‰</h3>
    <textarea id="approvalAction" placeholder="ìë™ ì‹¤í–‰ ëª…ë ¹ ì…ë ¥ (ì˜ˆ: ë¬¼ì£¼ê¸° ì‹œì‘)"></textarea>
    <button onclick="approveAndExecute()">ìŠ¹ì¸ í›„ ìë™ ì‹¤í–‰</button>
    <div id="execStatus" style="margin-top:1rem; color:#007c4d;"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "your-project.firebaseapp.com",
      databaseURL: "https://your-project.firebaseio.com",
      projectId: "your-project"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    async function sendSlackWithPDF() {
      const { jsPDF } = window.jspdf;
      const summary = document.getElementById("summaryText").value;
      const doc = new jsPDF();
      doc.text("AgriNexus ê´€ë¦¬ì ë³´ê³ ì„œ", 20, 20);
      doc.text("ë‚´ìš©: " + summary, 20, 40);
      doc.text("ì‹œê°„: " + new Date().toLocaleString(), 20, 60);
      const blob = doc.output("blob");

      const formData = new FormData();
      formData.append("pdf", blob, "report.pdf");

      const res = await fetch("https://your-server.com/send-slack-link", {
        method: "POST",
        body: formData
      });

      document.getElementById("slackStatus").innerText = "ğŸ“ PDF ë§í¬ í¬í•¨ Slack ë©”ì‹œì§€ ë°œì†¡ ì™„ë£Œ!";
    }

    function simulateIoTFailure() {
      const log = { type: "water", result: "ì‹¤íŒ¨", time: new Date().toISOString() };
      db.ref("iotResponses").push(log);
      fetch("https://your-server.com/notify-failure", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(log)
      });
      document.getElementById("alertResult").innerText = "ğŸš¨ ì‹¤íŒ¨ ì•Œë¦¼ ì „ì†¡ë¨!";
    }

    async function approveAndExecute() {
      const action = document.getElementById("approvalAction").value;
      db.ref("approvals").push({ action, approved: true, time: new Date().toISOString() });

      await fetch("https://iot-server.example.com/control", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ command: action })
      });

      document.getElementById("execStatus").innerText = "âœ… ìŠ¹ì¸ â†’ ìë™ ì‹¤í–‰ ëª…ë ¹ ì „ì†¡ë¨!";
    }
  </script>

</body>
</html>
