
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AgriNexus AI 예측 + PDF 리포트 + 관리자 차트</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial; background: #eef6f9; padding: 2rem; text-align: center; }
    input, button { padding: 0.7rem; margin: 0.4rem; width: 90%; max-width: 500px; border-radius: 6px; font-size: 1rem; border: 1px solid #ccc; }
    canvas { margin-top: 2rem; background: white; border-radius: 8px; }
    .output { margin-top: 1rem; color: #007c4d; font-size: 1.1rem; }
  </style>
</head>
<body>

  <h1>🌾 AgriNexus AI 기반 생육 예측 리포트</h1>

  <div>
    일사량 (W/m²): <input id="sun" type="number" /><br/>
    수분 (%): <input id="moist" type="number" /><br/>
    온도 (°C): <input id="temp" type="number" /><br/>
    <button onclick="predictGrowth()">📈 AI 예측 실행</button>
    <button onclick="generatePDF()">📄 PDF 리포트 생성</button>
  </div>

  <div class="output" id="predictionOut"></div>

  <canvas id="growthChart" width="700" height="300"></canvas>

  <script>
    const growthData = [];

    function predictGrowth() {
      const sun = parseFloat(document.getElementById("sun").value);
      const moist = parseFloat(document.getElementById("moist").value);
      const temp = parseFloat(document.getElementById("temp").value);

      let result = "🌱 성장 정상";
      if (sun < 200 || moist < 20 || temp < 10) result = "⚠️ 성장 불량 위험";
      else if (moist > 80 && temp > 30) result = "💧 과잉 수분 주의";

      document.getElementById("predictionOut").innerText = "AI 예측 결과: " + result;

      growthData.push({ x: new Date().toISOString(), y: moist });

      renderChart();
    }

    function renderChart() {
      const ctx = document.getElementById("growthChart").getContext("2d");
      new Chart(ctx, {
        type: "line",
        data: {
          datasets: [{
            label: "🌿 실시간 토양 수분 변화율",
            data: growthData,
            borderColor: "#007c4d",
            fill: false
          }]
        },
        options: {
          parsing: false,
          scales: {
            x: { type: 'time', time: { unit: 'minute' }, title: { display: true, text: '시간' } },
            y: { beginAtZero: true, max: 100, title: { display: true, text: '수분 (%)' } }
          }
        }
      });
    }

    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const sun = document.getElementById("sun").value;
      const moist = document.getElementById("moist").value;
      const temp = document.getElementById("temp").value;
      const prediction = document.getElementById("predictionOut").innerText;

      const doc = new jsPDF();
      doc.setFontSize(14);
      doc.text("AgriNexus AI 작물 생육 예측 리포트", 20, 20);
      doc.setFontSize(11);
      doc.text(`일사량: ${sun} W/m²`, 20, 40);
      doc.text(`수분: ${moist} %`, 20, 50);
      doc.text(`온도: ${temp} °C`, 20, 60);
      doc.text(`예측 결과: ${prediction}`, 20, 80);
      doc.text(`발행 시각: ${new Date().toLocaleString()}`, 20, 100);

      doc.save("AgriNexus_Growth_Report.pdf");
    }
  </script>

</body>
</html>
